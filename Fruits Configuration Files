

const mongoose = require('mongoose');
// Replace the uri string with your connection string.
mongoose.connect("mongodb://127.0.0.1:27017/fruitsDB", {useNewUrlParser:true});

const fruitSchema = new mongoose.Schema({
  name:String, 
  rating: Number, 
  review: String 
});

const Fruit = mongoose.model("Fruit", fruitSchema);

const fruit = new Fruit ({
  name: "Apple", 
  rating: 7, 
  review: "Pretty solid as a fruit."
});
//fruit.save();

const personSchema = new mongoose.Schema({
  name: String,
  age: Number, 
  favoriteFruit: fruitSchema 

});
  
const Person = mongoose.model("Person", personSchema);

const pineapple = new Fruit({
name: "Pineapple", 
score: 9, 
review: "great fruit"
});
pineapple.save();



const person = new Person({
  name: "Amy", 
  age: 12, 
favoriteFruit: pineapple
});

person.save();


Person.updateOne({name:"John"}, {favoriteFruit: mango}, function(err) {
if(err){  
     console.log(err);
} else {
      console.log("Successfully updated the document");
}
});

const mango = new Fruit({
name: "mango", 
score: 6, 
review: "Decent fruit", 
});

mango.save();


const kiwi = new Fruit({
  name : "kiwi", 
  score: 10, 
  review: "the best fruit"
});

const orange = new Fruit({
  name : "orange", 
  score: 4, 
  review: "Too sour for me"
});

const banana = new Fruit({
  name : "banana", 
  score: 3, 
  review: "Weird texture"
});


Fruit.insertMany([kiwi, orange, banana], ) 
  
    console.log("succes saved to fruitsDB");
  


const insertDocuments = function(db, callback) {


const collection = db.collection('fruits');

collection.insertMany([
  {
    name: "Apple", 
    score: 8,
    review: "Great fruit"
  },
  {
    name: "orange",
    score:6,
    review: "kinda sour"
  }


])
}
Fruit.insertMany([kiwi, orange, banana, pineapple, raspberries, watermellon, tomatoes], ) 
  
    console.log("successfully saved to fruitsDB");


// now all fruits are inserted into the array.

// find all fruits ====> use a For Loop to find all key : value fruits.id, fruits.name, fruits.score

//Fruit.find()
// .then((fruits) => {
//  fruits.forEach((fruits) => {
//    console.log(fruits.id, ":" , fruits.name, fruits.score, fruits.review);
//  });
// });

async function findAllFruit() {
  try {
        const allFruit = await Fruit.find({});
        mongoose.connection.close();
        allFruit.forEach(fruit => {
                console.log(fruit.name);
        })
      }  catch(error) {
              console.log(error);
      }

Fruit.updateOne({_id:"                "}, <name:"Peach"}, function(err) {
    if(err){
     console.log(err);
} else{ 
        console.log("Successfully updated the document");
}
});


Fruit.deleteOne({name: "Peach"}, function(err) {
    if(err) {
      console.log(err);
} else{    
      console.log("Successfully deleted the document");
});




Person.deleteMany({name: "John"}, function(err) {
  if(err) {
      console.log(err);
} else{
      console.log("successfully deleted the Person");
});

Person.updateOne({name: "John"}, 






}

// call the function findAllFruit

findAllFruit();










